# [2841.å‡ ä¹å”¯ä¸€å­æ•°ç»„çš„æœ€å¤§å’Œ](https://leetcode.cn/problems/maximum-sum-of-almost-unique-subarray/description/)

åˆæ˜¯ä¸€é“éå¸¸ç»å…¸çš„æ»‘åŠ¨çª—å£é¢˜å•Šï¼Œå°±æ˜¯å¤šäº†è¦ç”¨å“ˆå¸Œè¡¨å­˜å‚¨çš„åŠæ³•ç½¢äº†ï¼Œæˆ‘å…ˆæŠŠæˆ‘ç”¨ `unordered_set` å†™çš„æœ‰é—®é¢˜çš„è´´å‡ºæ¥ï¼š

```cpp

class Solution {
public:
    long long maxSum(vector& nums, int m, int k) {
        unordered_set hash;
        int sum = 0, max_sum = 0;

        for (int i = 0; i < k; ++i) {
            hash.insert(nums[i]);
            sum += nums[i];
        }
        if (hash.size() >= m) 
            max_sum = sum;
        
        for (int i = k; i < nums.size(); ++i) {
            hash.erase(nums[i - k]);
            hash.insert(nums[i]);
            sum += nums[i] - nums[i - k];
            if (hash.size() >= m) {
                max_sum = max(max_sum, sum);
            }
        }

        return max_sum;
    }
};
```

è¿™æ ·ä¹çœ‹ä¸Šå»å¥½åƒæ²¡å•¥é—®é¢˜ï¼Œä½†æ˜¯ä¸€æäº¤å°±éœ²å‡ºé¸¡è„šäº†ï¼Œå½“ `nums = 1111113` `k = m = 2` æ—¶ï¼Œå½“åœºæŠ¥é”™ï¼Œä»”ç»†çœ‹ç¡®å®ï¼Œæœ¬æ¥æŒ‰ç†æ¥è¯´è¿™ä¸ªæ¡ˆä¾‹çš„ç­”æ¡ˆæ˜¯2ï¼Œä½†æ˜¯æˆ‘è¿™æ ·å†™è¾“å‡ºçš„å°±æ˜¯
0äº†ï¼Œå› ä¸ºå½“èµ°åˆ°æœ€åä¸€ä¸ªæ•°æ—¶ï¼Œæœ¬æ¥ `set` é‡Œé¢è¿˜æœ‰ä¸€ä¸ª1çš„ï¼Œä½†æ˜¯ä¹‹åæŠŠ1 `erase` æ‰äº†ï¼Œå¯¼è‡´æŠŠ3 `insert` è¿›æ¥åå°±åªæœ‰ä¸€ä¸ªæ•°äº†ï¼Œè‡ªç„¶å°±é”™äº†ã€‚

ä¸‹é¢æ˜¯ç”¨GPTå†™çš„ç”¨ `unordered_map` å†™çš„æ­£ç¡®ç­”æ¡ˆï¼š

```cpp

class Solution {
public:
    long long maxSum(vector<int>& nums, int m, int k) {
        unordered_map<int, int> count_map;  // ç”¨æ¥è®°å½•çª—å£ä¸­æ¯ä¸ªå…ƒç´ çš„å‡ºç°æ¬¡æ•°
        int sum = 0, max_sum = 0;

        // åˆå§‹åŒ–å‰kä¸ªå…ƒç´ 
        for (int i = 0; i < k; ++i) {
            count_map[nums[i]]++;
            sum += nums[i];
        }

        // åˆ¤æ–­åˆå§‹çª—å£æ˜¯å¦æ»¡è¶³æ¡ä»¶
        if (count_map.size() >= m) {
            max_sum = sum;
        }

        // æ»‘åŠ¨çª—å£
        for (int i = k; i < nums.size(); ++i) {
            // åˆ é™¤çª—å£å·¦è¾¹çš„å…ƒç´ 
            count_map[nums[i - k]]--;
            if (count_map[nums[i - k]] == 0) {
                count_map.erase(nums[i - k]);  // å¦‚æœè¯¥å…ƒç´ çš„è®¡æ•°ä¸º0ï¼Œç§»é™¤å®ƒ

            }
            // æ·»åŠ æ–°çš„å…ƒç´ 
            count_map[nums[i]]++;
            sum += nums[i] - nums[i - k];

            // åˆ¤æ–­å½“å‰çª—å£æ˜¯å¦æ»¡è¶³æ¡ä»¶
            if (count_map.size() >= m) {
                max_sum = max(max_sum, sum);
            }
        }

        return max_sum;
    }
};

```
å’Œæˆ‘çš„æ€è·¯è¿˜æ˜¯åŸºæœ¬ä¸€è‡´çš„ï¼Œè™½ç„¶è¿™å°±æ˜¯é“æ¨¡æ¿æå°±æ˜¯äº†ğŸ˜‚ã€‚
